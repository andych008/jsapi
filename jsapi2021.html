<!DOCTYPE HTML>
<html>

<head>
    <title>LeanEngine</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h2>轻程序相关</h2>
    <hr />
    <div class="line">
        <button id="umGetSystemInfo">获取平台信息</button>
        <button id="umGetUserInfo">获取用户信息</button>
        <button id="umStartOne">打开轻程序</button>
    </div>
    <div class="line">
        <button id="umGetQAppId">获取轻程序qpId</button>
        <button id="umGetQAppVersion">获取轻程序版本号</button>
    </div>


    <h2>定位</h2>
    <hr />
    <div class="line">
        <button id="gaode">高德定位</button>
    </div>

    <h2>扫码</h2>
    <hr />
    <div class="line">
        <button id="umScan">扫一扫</button>
        <button id="umScanMultiple">多码扫码</button>
    </div>

    <h2>选择照片</h2>
    <hr />
    <div class="line">
        <button id="umImageSelect">选择照片</button>
        <button id="umImageSelect_camera">选择照片(拍照)</button>
        <img style="max-height: 200px;" id="id_img" src="" />
    </div>


    <h2>导航栏</h2>
    <hr />
    <div class="line">
        <button id="umSetQAppNavBackground">设置导航栏背景色</button>
        <button id="umGetQAppTitleColor">获取导航栏背景色</button>
    </div>
    <div class="line">
        <button id="umSetQAppTitle">设置导航栏标题内容</button>
        <button id="umSetQAppNavBackground_borderBottomColor">设置导航栏底线颜色</button>
        <button id="umSetQAppNavBackground_base64Logo">设置导航栏logo</button>
    </div>
    <div class="line">
        <button id="umShowQAppBackArrow">显示/隐藏导航栏返回按钮</button>
        <button id="umShowQAppNavBarLoading">显示/隐藏导航栏加载动画</button>
        <button id="umShowQAppNavBar">显示/隐藏导航栏</button>
    </div>
    <div class="line">
        <button id="umGetMenuButtonBoundingClientRect">获取胶囊坐标大小</button>
    </div>

    <h2>分享</h2>
    <hr />
    <div class="line">
        <button id="umShowShareMenu">打开/关闭当前轻程序分享功能</button>
        <button id="umGetShareInfo">获取到分享信息</button>
    </div>

    <h2>点评、点赞</h2>
    <hr />
    <div class="line">
        <button id="umShowThumbUpMenu">打开/关闭当前轻程序点赞功能</button>
        <button id="umShowEvaluateMenu">打开/关闭当前轻程序点评功能</button>

    </div>


    <hr />

    <hr />

    <hr />



    <script type="text/javascript">


        if (!window.navigator.userAgent.match('NebulaSDK')) {

            window.AlipayJSBridge = {
                call: function (api, param) {
                    console.log({ api: api })
                    // console.log({ api: api, param: param })
                    // if (typeof param == "undefined" || typeof param == "function") {
                    //     console.log({ api: api })
                    // } else {
                    //     console.log({ api: api, param: param })
                    // }
                }
            }
        }


        function bindClick(eleId, api = null, handler) {
            api = (api == null ? eleId : api)
            let element = document.getElementById(eleId)
            element.innerText = element.innerText + "\n" + api

            element.addEventListener("click", handler)
        }


        function bindClickAndExec(eleId, api = null, param = {}, handler = null) {
            api = (api == null ? eleId : api)
            let element = document.getElementById(eleId)
            element.innerText = element.innerText + "\n" + api

            element.addEventListener("click", () => {
                AlipayJSBridge.call(api, param, (result) => {
                    if (handler != null) {
                        handler(result)
                    } else {
                        console.log(JSON.stringify(result))
                        alert(JSON.stringify(result));
                    }
                });
            })
        }


        function StateBinder(eleId, api = null) {
            api = (api == null ? eleId : api)

            var flag = false;
            function f2(reqParma) {
                bindClick(eleId, api, () => {
                    event.target.style['background-color'] = flag ? '' : '#4fe7af';

                    let param = reqParma(flag)
                    console.log('param : ' + JSON.stringify(param))
                    AlipayJSBridge.call(api, param, (result) => {

                        console.log(JSON.stringify(result))
                        // alert(JSON.stringify(result));
                    });
                    flag = !flag;
                })
            }

            return f2;
        }

        function SwitchBinder(eleId, api1, api2) {
            var flag = false;
            function f2() {
                bindClick(eleId, api1 + "\n" + api2, () => {
                    event.target.style['background-color'] = flag ? '' : '#4fe7af';

                    AlipayJSBridge.call(flag ? api2 : api1);

                    flag = !flag;
                })
            }

            return f2;
        }

        bindClickAndExec("umGetSystemInfo")
        bindClickAndExec("umGetUserInfo")
        bindClickAndExec("umStartOne", api = null, param = { qpId: "QPID-fa9ffd15ce4a4e60ba0b42d37e52ec54" })
        bindClickAndExec("umGetQAppId")
        bindClickAndExec("umGetQAppVersion")


        bindClickAndExec("baidu", 'umGetBDLocation')



        bindClickAndExec("umScan")
        bindClickAndExec("umScanMultiple")


        bindClickAndExec("umImageSelect", api = "umImageSelect", param = { type: "photoLibrary" },
            handler = (result) => {
                console.log(result.code);
                document.getElementById('id_img').src = result.bussData.base64Img;
            })
        bindClickAndExec("umImageSelect_camera", api = "umImageSelect", param = { type: "camera" },
            handler = (result) => {
                console.log(result.code);
                document.getElementById('id_img').src = result.bussData.base64Img;
            })



        StateBinder("umSetQAppNavBackground")((flag) => {
            if (flag) {
                return { backGroundColor: "#ffffff" }
            } else {
                return { backGroundColor: "#ff3300" }
            }
        })
        bindClickAndExec("umGetQAppTitleColor")


        StateBinder("umSetQAppTitle")((flag) => {
            return { title: flag ? "" : "我是中文汉字一二三四五六七八九" }
        })
        StateBinder("umSetQAppNavBackground_borderBottomColor", "umSetQAppNavBackground")((flag) => {
            if (flag) {
                return { backGroundColor: "#ffffff", borderBottomColor: "#ffffff" }
            } else {
                return { backGroundColor: "#ffffff", borderBottomColor: "#ff3300" }
            }
        })
        StateBinder("umSetQAppNavBackground_base64Logo", "umSetQAppNavBackground")((flag) => {
            if (flag) {
                return { base64Logo: "" }
            } else {
                return { base64Logo: "data:image/ico;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJpYNgCAHZkAcAHbBHMA/wl5AP8PkQnbD5sZmQ2iMjMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhkcJAGMFogBVAP8AYgD/AHMA/wB0Bf8FjFj/Eq2b/xy1nf8TrnD/FqsvnxCtQgkAAAAAAAAAAAAAAAAAjU0JAGgEzwBpDv8AgSD/AIAh/wCNdP8FxPf/Ccv//xDK//8Zy///JNX//y/k//8ixI/GE7ROCQAAAAAAAAAAAIQmqACRR/8AkUH/AHkl/wCuvf8A1v7/Ac/7/wLM+/8Ey/7/Bsf//wbB//8Jyf//D9j//x3Uyp8AAAAAALKnOQCPSf8ApWj/AIMt/wC4vf8A4f//ANn6/wB0RP8AcUT/AM76/wDL//8Axf//Ab///wLK//8E1///CcK9MwDV8KIAx93/AKic/wDe9v8A6v//AOr//wDf+P8AUQD/AFAA/wDS+P8A0v//AMr//wDC//8Awf//AND//wnY/p8A9v/kAPP//wDt//8A7/7/Au36/wLr+P8A4PH/AFQA/wBUAP8A0vH/ANH4/wDM+v8Axv7/AL///wDJ//8G1P/eAPn//AD8//8H+///EvP7/wh6RP8AVgD/AFsA/wBbAf8AWAD/AFIA/wBPAP8AbET/AMb7/wDB//8Azv//Aub/+QD7//wG/v//Kv///1D6+/8XfT7/AF0E/wBgCf8AYgr/AFsB/wBUAP8ATAD/AGc+/wDK+/8Az///ANz//wLn//kA/P/kEf///1r///+x/v7/xvn6/5n2+P9R7/H/AGIL/wBbAP8A3fH/ANv4/wDV+v8A3P7/ANj//wDa//8C5v/eAPTwpRj///92////3f////3////P////b/b4/wBeBv8AWgD/AOT4/wDr//8A7P//AMvf/wCinP8AqrD/Aub/ogDMpzwP////W////7z////c////s////2L5+v8JfT7/AXg+/wDz+v8A9P//AMDC/wB5Iv8ASwD/AHEJ/wHLxDYAAAAAAubYqCT///9d////e////2T///83/v7/DPr7/wD3+/8A9/7/AL+8/wB4HP8Acgb/AFsA/wCGJaIAAAAAAAAAAAC4iAwBxp7PEe/j/yH///8b////Cv///wH9//8A5+f/AJd1/wCOMP8AjCf/AG0F/wCXOswAnFkJAAAAAAAAAAAAAAAAALqLDAC5hasAvYn/Cceg/wS3iP8ApnT/AIs9/wClTP8Amjn/AI8x/wClUKUBoF8JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMijOQDBkZ8AuHrqAK9k/wCuXv8Aq1nnAK9gnwK0ejYAAAAAAAAAAAAAAAAAAAAA8A8AAMADAACAAQAAgAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAEAAIABAADAAwAA8A8AAA==" }
            }
        })

        SwitchBinder("umShowQAppBackArrow", "umShowQAppBackArrow", "umHideQAppBackArrow")()
        SwitchBinder("umShowQAppNavBarLoading", "umShowQAppNavBarLoading", "umHideQAppNavBarLoading")()
        SwitchBinder("umShowQAppNavBar", "umShowQAppNavBar", "umHideQAppNavBar")()

        bindClickAndExec("umGetMenuButtonBoundingClientRect")


        SwitchBinder("umShowShareMenu", "umShowShareMenu", "umHideShareMenu")()
        bindClickAndExec("umGetShareInfo")


        SwitchBinder("umShowThumbUpMenu", "umShowThumbUpMenu", "umHideThumbUpMenu")()
        SwitchBinder("umShowEvaluateMenu", "umShowEvaluateMenu", "umHideEvaluateMenu")()






    </script>
</body>

</html>